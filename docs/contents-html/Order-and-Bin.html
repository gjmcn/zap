<h2>Order and Bin</h2>
<hr>
<h4 id="order"><code>order</code>, <code>orderIndex</code></h4>
<p><code>order</code> takes an iterable and a 'comparison function' (see the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort"><code>sort</code> array method</a>), and returns a new array containing the sorted elements of the iterable. The default comparison function is <code>[a - b]</code> which sorts (finite) numbers or dates in ascending order:</p>
<pre><code><span class="zap-operator">@</span> <span class="zap-number">5</span> <span class="zap-number">9</span> <span class="zap-number">2</span> <span class="zap-keyword">order</span>   <span class="zap-comment">// [2, 5, 9]</span>

<span class="zap-identifier">x</span> <span class="zap-operator">=</span> <span class="zap-operator">@</span> 
<span class="zap-punctuation">|</span> <span class="zap-punctuation">(</span><span class="zap-operator">#</span> <span class="zap-identifier">u</span> <span class="zap-number">5</span> <span class="zap-identifier">v</span> <span class="zap-number">20</span><span class="zap-punctuation">)</span>
<span class="zap-punctuation">|</span> <span class="zap-punctuation">(</span><span class="zap-operator">#</span> <span class="zap-identifier">u</span> <span class="zap-number">6</span> <span class="zap-identifier">v</span> <span class="zap-number">10</span><span class="zap-punctuation">)</span>
<span class="zap-punctuation">|</span> <span class="zap-punctuation">(</span><span class="zap-operator">#</span> <span class="zap-identifier">u</span> <span class="zap-number">7</span> <span class="zap-identifier">v</span> <span class="zap-number">30</span><span class="zap-punctuation">)</span>   <span class="zap-comment">// array of objects</span>

<span class="zap-comment">// sort on property v, descending</span>
<span class="zap-identifier">x</span> <span class="zap-keyword">order</span> <span class="zap-punctuation">[</span><span class="zap-identifier">b</span> <span class="zap-operator">:</span><span class="zap-identifier">v</span> <span class="zap-operator">-</span> <span class="zap-punctuation">(</span><span class="zap-identifier">a</span> <span class="zap-operator">:</span><span class="zap-identifier">v</span><span class="zap-punctuation">)</span><span class="zap-punctuation">]</span>   <span class="zap-comment">// [{u: 7, v: 30}, {u: 5, v: 20}, {u: 6, v: 10}]</span>

<span class="zap-comment">// orderIndex</span>
<span class="zap-identifier">x</span> <span class="zap-keyword">orderIndex</span> <span class="zap-punctuation">[</span><span class="zap-identifier">b</span> <span class="zap-operator">:</span><span class="zap-identifier">v</span> <span class="zap-operator">-</span> <span class="zap-punctuation">(</span><span class="zap-identifier">a</span> <span class="zap-operator">:</span><span class="zap-identifier">v</span><span class="zap-punctuation">)</span><span class="zap-punctuation">]</span>   <span class="zap-comment">// [2, 0, 1]</span>
</code></pre>
<p>As shown in the final example, <code>orderIndex</code> can be used to get the original indices of the sorted elements.</p>
<hr>
<h4 id="bin"><code>bin</code>, <code>binCount</code></h4>
<p><code>bin</code> takes an iterable to bin, an iterable of bin limits and a 'comparison function' (see <a href="#order"><code>order</code></a> and the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort"><code>sort</code> array method</a>). The default comparison function is <code>[a - b]</code> which is suitable for binning (finite) numbers or dates. <code>bin</code> returns a map with arrays for values:</p>
<pre><code><span class="zap-operator">@</span> <span class="zap-number">5</span> <span class="zap-number">9</span> <span class="zap-number">12</span> <span class="zap-number">7</span> <span class="zap-keyword">bin</span> <span class="zap-punctuation">(</span><span class="zap-operator">@</span> <span class="zap-number">10</span> <span class="zap-number">20</span><span class="zap-punctuation">)</span>   <span class="zap-comment">// Map {10 =&gt; [5, 9, 7], 20 =&gt; [12]}</span>

<span class="zap-identifier">x</span> <span class="zap-operator">=</span> <span class="zap-operator">@</span> 
<span class="zap-punctuation">|</span> <span class="zap-punctuation">(</span><span class="zap-operator">@</span> <span class="zap-number">23</span> <span class="zap-number">0</span><span class="zap-punctuation">)</span> <span class="zap-punctuation">(</span><span class="zap-operator">@</span> <span class="zap-number">7</span> <span class="zap-number">1</span><span class="zap-punctuation">)</span> <span class="zap-punctuation">(</span><span class="zap-operator">@</span> <span class="zap-number">32</span> <span class="zap-number">2</span><span class="zap-punctuation">)</span> 
<span class="zap-punctuation">|</span> <span class="zap-punctuation">(</span><span class="zap-operator">@</span> <span class="zap-number">38</span> <span class="zap-number">3</span><span class="zap-punctuation">)</span> <span class="zap-punctuation">(</span><span class="zap-operator">@</span> <span class="zap-number">3</span> <span class="zap-number">4</span><span class="zap-punctuation">)</span> <span class="zap-punctuation">(</span><span class="zap-operator">@</span> <span class="zap-number">34</span> <span class="zap-number">5</span><span class="zap-punctuation">)</span>   <span class="zap-comment">// array of arrays</span>

<span class="zap-identifier">limits</span> <span class="zap-operator">=</span> <span class="zap-operator">@</span> <span class="zap-number">10</span> <span class="zap-number">20</span> <span class="zap-number">30</span> <span class="zap-number">40</span>

<span class="zap-identifier">x</span> <span class="zap-keyword">bin</span> <span class="zap-identifier">limits</span> <span class="zap-punctuation">[</span><span class="zap-identifier">a</span> <span class="zap-operator">:</span><span class="zap-number">0</span> <span class="zap-operator">-</span> <span class="zap-identifier">b</span><span class="zap-punctuation">]</span>   <span class="zap-comment">// Map {</span>
                          <span class="zap-comment">//   10 =&gt; [[7, 1], [3, 4]],</span>
                          <span class="zap-comment">//   20 =&gt; [],</span>
                          <span class="zap-comment">//   30 =&gt; [[23, 0]],</span>
                          <span class="zap-comment">//   40 =&gt; [[32, 2], [38, 3], [34, 5]]</span>
                          <span class="zap-comment">// }</span>

<span class="zap-comment">// second callback</span>
<span class="zap-identifier">x</span> <span class="zap-keyword">bin</span> <span class="zap-identifier">limits</span> <span class="zap-punctuation">[</span><span class="zap-identifier">a</span> <span class="zap-operator">:</span><span class="zap-number">0</span> <span class="zap-operator">-</span> <span class="zap-identifier">b</span><span class="zap-punctuation">]</span> <span class="zap-punctuation">[</span><span class="zap-identifier">a</span> <span class="zap-keyword">map</span> <span class="zap-identifier">v</span> <span class="zap-punctuation">(</span><span class="zap-identifier">v</span> <span class="zap-operator">:</span><span class="zap-number">1</span><span class="zap-punctuation">)</span><span class="zap-punctuation">]</span>   <span class="zap-comment">// Map {</span>
                                           <span class="zap-comment">//   10 =&gt; [1, 4]</span>
                                           <span class="zap-comment">//   20 =&gt; []</span>
                                           <span class="zap-comment">//   30 =&gt; [0]</span>
                                           <span class="zap-comment">//   40 =&gt; [2, 3, 5]</span>
                                           <span class="zap-comment">// }</span>

<span class="zap-comment">// binCount</span>
<span class="zap-operator">@</span> <span class="zap-number">5</span> <span class="zap-number">9</span> <span class="zap-number">12</span> <span class="zap-number">7</span> <span class="zap-keyword">binCount</span> <span class="zap-punctuation">(</span><span class="zap-operator">@</span> <span class="zap-number">10</span> <span class="zap-number">20</span><span class="zap-punctuation">)</span>   <span class="zap-comment">// Map {10 =&gt; 3, 20 =&gt; 1}</span>
<span class="zap-identifier">x</span> <span class="zap-keyword">binCount</span> <span class="zap-identifier">limits</span> <span class="zap-punctuation">[</span><span class="zap-identifier">a</span> <span class="zap-operator">:</span><span class="zap-number">0</span> <span class="zap-operator">-</span> <span class="zap-identifier">b</span><span class="zap-punctuation">]</span>    <span class="zap-comment">// Map {10 =&gt; 2, 20 =&gt; 0, 30 =&gt; 1, 40 =&gt; 3}</span>
<span class="zap-identifier">x</span> <span class="zap-keyword">binCount</span> <span class="zap-identifier">limits</span> <span class="zap-punctuation">[</span><span class="zap-identifier">a</span> <span class="zap-operator">:</span><span class="zap-number">0</span> <span class="zap-operator">-</span> <span class="zap-identifier">b</span><span class="zap-punctuation">]</span> <span class="zap-punctuation">[</span><span class="zap-identifier">a</span> <span class="zap-operator">&gt;</span> <span class="zap-number">1</span><span class="zap-punctuation">]</span>   <span class="zap-comment">// Map {</span>
                                       <span class="zap-comment">//   10 =&gt; true,</span>
                                       <span class="zap-comment">//   20 =&gt; false,</span>
                                       <span class="zap-comment">//   30 =&gt; false,</span>
                                       <span class="zap-comment">//   40 =&gt; true</span>
                                       <span class="zap-comment">// }</span>
</code></pre>
<p>As shown in the example, <code>bin</code> can take a second callback. This is applied to each bin (it is passed a value and key of the map at each step) and the results are used as the values of the returned map.</p>
<p><code>binCount</code> gets the number of elements in each bin — see the final examples above. While we could use <code>bin</code> with a second callback for this, <code>binCount</code> is more efficient and is easier to read.</p>
<p>An element is assigned to a bin if the comparison function (which is passed the element and the bin limit) is less than or equal to 0. Using the default comparison function <code>[a - b]</code> is equivalent to specifying inclusive upper bin limits — use <code>[b - a]</code> to specify lower bin limits. Elements that are not assigned to any bin do not appear in the map returned by <code>bin</code> (or contribute to any value in <code>binCount</code>).</p>
<blockquote>
<p><code>bin</code> and <code>binCount</code> assume that the bin limits are already sorted (with respect to the comparison function). If this is not the case, <code>bin</code> and <code>binCount</code> will give unexpected results.</p>
</blockquote>
<blockquote>
<p>The elements inside each bin are <em>not</em> sorted — they appear in the same order as in the original iterable.</p>
</blockquote>

<br><br><br>